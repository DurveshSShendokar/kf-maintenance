<style>
.table-bordered tr th, .table-bordered tr td, .table-bordered tr{border: 1px solid #ccc !important;}
.orange { background-color: #008B8B; }
.orange th { color: #fff; }
.navbar {
    background-color: #008B8B;
    padding: 10px 0;
    color: #fff;
    text-align: center;
    text-decoration: none;
}
.btn_search {
    background-color: #008B8B;
    border: 1px solid #008B8B;
    color: white;
}
.form-control {
    width: 100%;
}
.table-bordered {
    width: 70%;
    margin: 0 auto; 
}
.center-button {
    display: flex;
     justify-content: flex-end;
    margin-top: 20px;
}
</style>
<div class="container">
    <div class="row page-title-div">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <h2 class="title" style="text-align: center;">Breakdown Report</h2>
        </div>
    </div>
    <br>

  
    <div class="row">
    
    	
    
        <div class="col-md-6">
            <div class="form-group">
                <label for="filterType">Filter By <span style="color:#c00;">*</span> :</label>
                <select ng-model="vm.filterType" class="form-control" required ng-change="vm.handleFilterChange()">
                 <option value="">Select Filter</option>
                    <option value="all">All</option>
                    <option value="date">Date</option>
                </select>
            </div>
        </div>
         <div class="col-md-6 center-button">
          
            <button type="button" class="btn_search" ng-click="vm.exportToExcel()" >Export</button>
        </div>
        
    </div>

   
    <div class="row" ng-if="vm.filterType === 'date'">
        <div class="col-md-6">
            <div class="form-group">
                <label for="startDate">Start Date <span style="color:#c00;">*</span> :</label>
                <input type="date" ng-model="vm.startDate" class="form-control" required />
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label for="endDate">End Date <span style="color:#c00;">*</span> :</label>
                <input type="date" ng-model="vm.endDate" class="form-control" required />
            </div>
        </div>
    </div>

   
</div>

<!-- Table Section -->
<div class="container">
    <div class="panel-body table-responsive">
        <table datatable="ng" id="example" class="table table-bordered">
            <thead class="orange">
                <tr>
                    <th>Sr No</th>
                    <th>Machine Name</th>
                    <th>Equipment ID</th>
               
                 
                    <th>Status</th>
                    <th>Breakdown Slip No</th>
                    <th>Root Cause</th>
                     <th>Corrective Action </th>
                      <th> Breakdown description</th>
                      <th>Raised By</th>
                     
                        <th>Attend By</th>
                          <th>Trial By</th> 
						  
                    <th>Raised Time</th>
					<th>WorkStart Time</th>
                    <th>Trial Time</th>
                    <th>Closed Time</th>
                     <th>TBF (IN DAYS)</th>
                    <th>Raise To Trial Time (In Hours:minutes)</th>
                    <th>Trial To Closed Time (In Hours:minutes)</th>
                    <th>Raise To Closed Time (In Hours:minutes)</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="break in vm.breakRepo">
                    <td>{{$index + 1}}</td>
                    <td>{{break.breakdown.machine.machine_name}}</td>
                    <td>{{break.breakdown.machine.eqid}}</td>
                
                    <td>
                        <span ng-switch="break.breakdown.status">
                            <span ng-switch-when="1">Open</span>
                            <span ng-switch-when="2">Trial</span>
                            <span ng-switch-when="3">Closed</span>
                        </span>
                    </td>
                    <td>{{break.breakdown.bd_slip}}</td>
                    <td>{{break.breakdown.root_cause}}</td>
                     <td>{{break.breakdown.action_taken}}</td>
                      <td>{{break.breakdown.observation}}</td>
                    
                     <td>{{break.breakdown.addedBy.firstName}} {{break.breakdown.addedBy.lastName}}</td>
					 <td>
					 								  {{ break.breakdown.updateBy ? (break.breakdown.updateBy.firstName + ' ' + (break.breakdown.updateBy.lastName || '')) : 'N/A' }}
					 								</td>
					 								<td>
					 								  {{ break.breakdown.trialBy ? (break.breakdown.trialBy.firstName + ' ' + (break.breakdown.trialBy.lastName || '')) : 'N/A' }}
					 								</td>
                      
												
													<td ng-if="break.breakdown.attendedUsers">{{break.breakdown.attendedUsers }}</td>
													                  <td ng-if="!break.breakdown.attendedUsers">N/A</td>
 
                    <td>{{break.ticketRaisedTime | date : 'dd-MM-yyyy : hh:mm a'}}</td>
					
					<td ng-if="break.breakdown.actualWorkingStartTime">{{break.breakdown.actualWorkingStartTime |  date : 'dd-MM-yyyy :  hh:mm a'}}</td>
					                    <td ng-if="!break.breakdown.actualWorkingStartTime">N/A</td>
					
                    <td ng-if="break.ticketTrialTime">{{break.ticketTrialTime | date : 'dd-MM-yyyy : hh:mm a'}}</td>
                    <td ng-if="!break.ticketTrialTime">N/A</td>
                    <td ng-if="break.ticketClosedTime">{{break.ticketClosedTime |  date : 'dd-MM-yyyy :  hh:mm a'}}</td>
                    <td ng-if="!break.ticketClosedTime">N/A</td>
                    <td>{{break.tbf}}</td>
                     <td>{{break.raiseToTrial}}</td>
                    <td>{{break.trialToClosed}}</td>
                    <td>{{break.totalTime}}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
